**Задача 1: Выбор решения для API Gateway**

Анализ популярных инструментов

| Характеристика          | NGINX | Traefik | Envoy | HAProxy | Apache APISIX |
|------------------------|---------------|---------|-------|---------|---------------|
| **Маршрутизация**      | Да | Да | Да | Да | Да |
| **Аутентификация**     | Плагины | Через middleware | Да | Вручную | Да |
| **Терминация HTTPS**   | Да | Да | Да | Да | Да |
| **Балансировка нагрузки** | Да | Да | Да | Да | Да |
| **Интеграция с сервисами аутентификации (OAuth2, JWT)** | Через плагины | Требует доработки | Да | Сложная настройка | Да |
| **Поддержка Service Mesh** | Через сторонние решения | Ограничено | Да | Ограничено | Да |
| **Конфигурирование** | Файлы, API| Динамическое | API, YAML | Файлы | API, YAML |
| **Простота настройки** | Средняя | Высокая | Средняя | Средняя | Средняя |


**Рекомендованное решение: Kong Gateway (Open Source)**

Пояснение выбора:
Kong — это гибкий и надёжный API Gateway с открытым исходным кодом, который хорошо подходит для микросервисной архитектуры. Он удовлетворяет всем предъявленным требованиям:

    1. Обеспечивает маршрутизацию по заранее заданной конфигурации.
    2. Имеет встроенные средства проверки токенов и других данных авторизации (например, через JWT или OAuth2).
    3. Поддерживает завершение HTTPS-соединений.
    4. Расширяется за счёт Lua-плагинов, что даёт гибкость в адаптации под конкретные нужды.

*Почему не Traefik или Istio?*

Traefik отлично интегрируется с Kubernetes, но проверка токенов потребует подключения сторонних инструментов.

Istio — мощный, но требует существенных затрат на внедрение и обучение команды

NGINX — надёжен, но потребует ручной реализации логики авторизации.

---

**Задача 2: Сравнение и выбор брокера сообщений**
Сравнительный обзор популярных решений

| Характеристика                     | RabbitMQ          | Apache Kafka      | NATS JetStream  | ActiveMQ Artemis | Redis Streams |
|-------------------------------------|-------------------|-------------------|-----------------|------------------|---------------|
| **Кластеризация**                   | Да (Mirrored Queues, Quorum Queues) | Да (репликация, ISR) | Да (JetStream, Supercluster) | Да (Master-Slave, Network of Brokers) | Да (Sentinel, Cluster Mode) |
| **Хранение сообщений на диске**      | Да (если включено) | Да (журнал в commit log) | Да (JetStream) | Да (Journal + KahaDB) | Да (RDB/AOF) |
| **Высокая скорость работы**          | Средняя (задержки при подтверждении) | Очень высокая (батчи, асинхронная запись) | Высокая (легковесный) | Средняя | Высокая (но не для больших объемов) |
| **Поддержка различных форматов сообщений** | Да (JSON, Protobuf, XML и др.) | Да (JSON, Avro, Protobuf) | Да (JSON, Protobuf) | Да (JSON, XML, Protobuf) | Да (JSON, MsgPack) |
| **Разделение прав доступа**          | Да (LDAP, ACL, Vhost) | Да (ACL, SASL, Kerberos) | Ограниченно (только базовая ACL) | Да (JAAS, LDAP, ACL) | Ограниченно (простые ACL) |
| **Простота эксплуатации**            | Средняя (требует настройки и мониторинга) | Сложная (ZooKeeper, продвинутая настройка) | Простая | Средняя (но проще, чем Kafka) | Очень простая |

Рекомендованное решение: RabbitMQ
Аргументация:

    1. RabbitMQ — проверенное временем решение, отлично подходящее для задач обмена сообщениями между микросервисами:
    2. Поддерживает кластеры и обеспечивает отказоустойчивость.
    3. Гарантирует надёжную доставку сообщений благодаря сохранению их на диск.
    4. Прост в развертывании, мониторинге и сопровождении.
    5. Обеспечивает гибкую систему прав доступа и изоляции между потоками.
    6. Поддерживает различные протоколы (AMQP, MQTT, STOMP), что расширяет его применимость.

Когда стоит выбрать Kafka:

Если система предполагает экстремально высокие объёмы данных и необходима обработка потоков в реальном времени, Kafka может быть предпочтительнее. Однако его эксплуатация требует больше ресурсов и квалификации.
